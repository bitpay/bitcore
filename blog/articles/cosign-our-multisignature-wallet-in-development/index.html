<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <title>Cosign: Our Multisignature Wallet In Development - Bitcore Blog
    </title>
    <link rel="alternate" href="http://localhost:8080/feed.xml" type="application/rss+xml" title="A pure, powerful blog for your daily reading.">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Ubuntu+Mono|Ubuntu:300,400,500,700,400italic,500italic,700italic|Lora:400,700,400italic,700italic|Anonymous+Pro:400,700,400italic,700italic|Merriweather:400,700,300">
    <link rel="stylesheet" href="/blog/css/main.css">
  </head>
  <body class="article-detail">
    <header class="header">
      <div class="header-image"><img src="/blog/bitcore-logo.png" alt="Bitcore"></div>
      <div class="content-wrap">
        <div class="logo">
          <h1><a href="/blog/">Bitcore Blog</a></h1>
          <p class="description">A pure, powerful blog for your daily reading.</p>
        </div>
      </div>
    </header>
    <div id="content">
      <div class="content-wrap">
        <article class="article">
          <header>
            <p class="date"><span>25. March 2014</span></p>
            <h2><a href="/blog/articles/cosign-our-multisignature-wallet-in-development/">Cosign: Our Multisignature Wallet In Development</a></h2>
            <p class="author"><span class="author">Ryan X. Charles</span>
            </p>
          </header>
          <section class="content"><p>One of the greatest problems in bitcoin is security.
Countless individuals and companies have lost their bitcoins due to compromised private keys.
Multisignature transactions offer a solution to this problem.
They just need to be&nbsp;user-friendly.</p>
<p>That is the idea behind Cosign, a multisignature wallet being developed by the bitcore team.
It should be just as easy to spend multisignature bitcoins as regular (“single signature”) bitcoins, except other people (or computers) have to sign the transactions before they are&nbsp;valid.</p>
<p>The way this works is that when someone from a, say, 3-of-5 multisignature wallet wishes to spend bitcoins, they can spend the bitcoins just like normal.
Then the partially signed transaction shows up on their cosigners’ screens, which they can choose to sign or not sign.
If three people sign the transaction, then it is broadcast to the bitcoin&nbsp;network.</p>
<p>This provides another layer of protection for theft.
If your private keys are compromised, it doesn’t mean your bitcoins are stolen.
The thief has to steal your private keys and those of your cosigners before they can spend the&nbsp;bitcoins.</p>
<p>Though easy to use, Cosign takes every measure to retain the full security of multisignature transactions.
There are a couple of key points that Cosign must satisfy to retain this full&nbsp;security:</p>
<ol>
<li>The private keys must be generated client-side and must remain client-side. If they are ever stored remotely, they must first be encrypted with a strong&nbsp;password.</li>
<li>The software must be open-source, and stored and executed client-side, so that it can be audited and cannot be changed by a third&nbsp;party.</li>
</ol>
<p>Cosign takes advantage of a number of modern browser and bitcoin technologies to make this possible.
Web <span class="caps">RTC</span> is used to establish p2p connections between cosigners.
HTML5 local storage is used to store the wallet.
HD extended keys are used to simplify the generation of new&nbsp;addresses.</p>
<p>It works like this.
Five people (or thereabouts) wish to participate in multisignature transactions where three of them (or so) are required to sign&nbsp;transactions.</p>
<p>First, one of them opens up Cosign and creates a new wallet, and then shares the <span class="caps">ID</span> of the wallet with the four cosigners.
All of the cosigners join the wallet and generate a new extended private key, which has a corresponding extended public key.
The extended public key is shared with the others.
The extended private key is kept&nbsp;private.</p>
<p>Now the cosigners can view their multisignature wallet just like a normal wallet.
The appearance and workflow of the wallet are almost exactly the same, with only one catch:
When someone wishes to send bitcoins, the bitcoins are not immediately sent.
Instead, the partially signed transaction is shared with the other cosigners.
If three of them sign it, then the transaction is complete, and can be broadcast to the bitcoin network and stored in the&nbsp;blockchain.</p>
<h2 id="mockups">Mockups</h2>
<p>Thanks to Bechi, we now have some beautiful mockups of this&nbsp;workflow.</p>
<p><img src="/blog/images/cosign-1-join.jpg" alt="1"></p>
<p>First, one of the cosigners opens Cosign and creates a new wallet.
The wallet <span class="caps">ID</span> is a random number that is automatically generated.
This ID is then shared with the other cosigners so they can all visit the wallet.
The other cosigners copy+paste the ID to join the wallet, similar to sharing a Google Hangouts&nbsp;link.</p>
<p><img src="/blog/images/cosign-2-home.jpg" alt="2"></p>
<p>Upon joining a wallet, the cosigners will generate a new, random master extended private key, which will be used to generate master public keys, which are automatically shared with the other members of the wallet.
Addresses formed from these master keys can be seen in the addresses list, just like a normal bitcoin&nbsp;wallet.</p>
<p><img src="/blog/images/cosign-3-txs.jpg" alt="3"></p>
<p>The transactions page is where the magic happens.
This page looks almost the same as a regular transactions page, with one key difference: When a cosigner sends bitcoins, it is regarded as “partially signed,” and shows up on the screens of the other cosigners.
The other cosigners can either choose to sign or to ignore the transaction.
If enough cosigners sign the transaction (say, three, in the case of a 3-of-5 multisig wallet), the transaction is fully signed and automatically broadcast to the bitcoin&nbsp;network.</p>
<p><img src="/blog/images/cosign-4-send.jpg" alt="4"></p>
<p>When a cosigner wishes to send bitcoins, they visit the send page, just like a normal bitcoin wallet.
The only difference is that the transaction is not broadcast to the bitcoin network until sufficiently many cosigners sign the&nbsp;transaction.</p>
<p><img src="/blog/images/cosign-5-backup.jpg" alt="5"></p>
<p>The wallet, which contains only the public keys of the cosigners, should be backed up in case of disaster.
So long as the wallet is backed up and at least (say) three of the cosigners have their master private keys, the bitcoins can be&nbsp;recovered.</p>
<p>It’s worth discussing some of the technologies we are using to build this projects and&nbsp;why.</p>
<h2 id="hd-wallets"><span class="caps">HD</span>&nbsp;Wallets</h2>
<p>If you’ve ever considered how best to handle multisignature transactions, you’ve encountered the difficulty in sharing public keys with the cosigners.
Every time you generate a new, random private key, you have to share the corresponding public key, which is burdensome.
Either that, or you re-use the same addresses over and over again, which is terrible for&nbsp;privacy.</p>
<p><span class="caps">HD</span> wallets as described in <a href="https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki"><span class="caps">BIP</span> 32</a> solve this problem by allowing one master extended private key to generate, deterministically, infinitely many private/public key pairs.
Importantly, extended public keys can be derived from the master extended public key.
This means you share one extended public key with your cosigners, and there is no need to share more public keys after that.
All of the cosigners have every address that will ever be generated right from the start.
This greatly increases the ease of sharing public&nbsp;keys.</p>
<h2 id="web-rtc">Web&nbsp;<span class="caps">RTC</span></h2>
<p>Cosign is a web application that is run locally.
By using web technologies, we’re able to make an app that can run pretty much anywhere, and can be improved and audited by a huge number of developers.
One of the neatest new pieces of technology to come to the web is <a href="http://www.webrtc.org/">Web <span class="caps">RTC</span></a>, which allows (almost) p2p connections in the browser.
The only central element of this is a server that exists solely to facilitate the creation of the p2p connection, after which the central server is no longer&nbsp;needed.</p>
<p>The ultimate goal of Cosign is to have a genuinely p2p app with no need whatsoever for a central server, but that is not yet possible from the browser, so we will get as close to that as we&nbsp;can.</p>
<h2 id="html-5-local-storage"><span class="caps">HTML</span> 5 Local&nbsp;Storage</h2>
<p>Running apps in the browser used to be far more limited, but today, <span class="caps">HTML</span> 5 local storage allows apps to keep significant amounts of data stored locally so that no central server is required to store anything.
The public wallet (containing the public keys) is shared amongst all cosigners, as are other critical pieces of information such as unspent transaction&nbsp;outputs.</p>
<p>Between Web <span class="caps">RTC</span> and HTML 5 local storage, it is actually possible to have a web wallet that runs locally with no need for a central server except the p2p facilitator. Oh, and one more important&nbsp;piece.</p>
<h2 id="insight-and-spv">Insight and&nbsp;<span class="caps">SPV</span></h2>
<p>Cosign is developed by the same people that developed <a href="http://insight.bitcore.io/">Insight</a>, a powerful, open-source blockchain <span class="caps">API</span> and client.
Cosign uses insight to find unspent transaction outputs and broadcast transactions to the bitcoin network.
Long-term, however, we believe it will be possible to implement <a href="https://en.bitcoin.it/wiki/Scalability#Simplified_payment_verification"><span class="caps">SPV</span></a> in the browser, where the only need for a server will be to bridge the Web <span class="caps">RTC</span> communication protocol with the real bitcoin p2p protocol.
In the meantime, running insight locally means there is no central server except the p2p&nbsp;facilitator.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Cosign development is only just now getting underway.
Look forward to more discussion of the technical challenges along the way as we build the most secure wallet in the&nbsp;world.</p>
</section>
        </article>
      </div>
    </div>
    <footer>
      <div class="content-wrap">
        <div class="nav"><a href="/blog/">« Blog Home</a></div>
        <section class="about"><p><a href="http://bitcore.io/">Bitcore</a> is an open-source implementation of bitcoin in javascript that works both in node and the browser.
Our goal is to make it as easy as possible to develop apps for bitcoin.</p>

        </section>
        <section class="copy">
          <p>&copy; 2014 Bitcore Team. Blog powered by&nbsp;<a href="https://github.com/jnordberg/wintersmith">Wintersmith.</a>
          </p>
        </section>
      </div>
    </footer>
  </body>
</html>